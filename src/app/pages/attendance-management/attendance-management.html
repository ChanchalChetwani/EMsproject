<div class="attendance-container">
  <app-sidebar></app-sidebar>

  <div class="main-content">
    <app-topbar></app-topbar>

    <!-- Attendance Management -->
    <div class="attendance-card">
      <div class="header-row">
        <h3>Attendance Management</h3>
        <div class="actions">
          <!-- Month Dropdown -->
        <button mat-button [matMenuTriggerFor]="monthMenu" class="me-2 light-gray-btn">
  <i class="fas fa-filter me-1"></i> View
</button>

<mat-menu #monthMenu="matMenu">
  <button mat-menu-item (click)="applyMonthFilter('')">All Months</button>
  <button mat-menu-item *ngFor="let month of months" (click)="applyMonthFilter(month)">
    {{ month }}
  </button>
</mat-menu>



          <button class="btn btn-primary" (click)="downloadReport()">
            <i class="bi bi-download"></i> Download
          </button>
        </div>
      </div>

      <!-- Attendance Search -->
      <div class="search-input">
        <i class="fas fa-search"></i>
        <input type="text" [(ngModel)]="searchAttendance" placeholder="Search Attendance" class="form-control"
          (input)="onAttendanceSearch()" />
      </div>

      <!-- Attendance Table -->
      <div class="table-container">
        <table class="custom-table">
          <thead>
            <tr>
              <th><input type="checkbox" (change)="toggleSelectAll($event)" [checked]="selectAllChecked" /></th>
              <th>Employee Id</th>
              <th>Name</th>
              <th>Designation</th>
              <th>Check In</th>
              <th>Check Out</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let emp of filteredAttendanceList">
              <td><input type="checkbox" [(ngModel)]="emp.selected" /></td>
              <td>{{ emp.employeeId }}</td>
              <td>{{ emp.name }}</td>
              <td>{{ emp.designation }}</td>
              <td>{{ emp.checkIn }}</td>
              <td>{{ emp.checkOut }}</td>
              <td>
                <span [ngClass]="getStatusClass(emp.status)">
                  {{ emp.status }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Correction Requests -->
    <div class="attendance-card mt-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5>Correction Requests</h5>
        <div class="search-input">
          <i class="fas fa-search"></i>
          <input type="text" [(ngModel)]="searchCorrection" placeholder="Search Correction" class="form-control"
            (input)="onCorrectionSearch()" />
        </div>
      </div>

      <!-- Correction Table -->
      <div class="table-container">
        <table class="custom-table">
          <thead>
            <tr>
              <th>
                <input type="checkbox" [(ngModel)]="selectAll" (change)="toggleAll()" />
              </th>
              <th>Employee Id</th>
              <th>Name</th>
              <th>Date</th>
              <th>Type</th>
              <th>Original</th>
              <th>Requested</th>
              <th>Reason</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let req of filteredCorrections">
              <td><input type="checkbox" [(ngModel)]="req.selected" /></td>
              <td>{{ req.employeeId }}</td>
              <td>{{ req.name }}</td>
              <td>{{ req.date }}</td>
              <td>{{ req.type }}</td>
              <td>{{ req.original }}</td>
              <td>{{ req.requested }}</td>
              <td>{{ req.reason }}</td>
             <td class="text-center">
  <button class="btn btn-outline-success btn-sm me-1" (click)="approveRequest(req)">
    <i class="bi bi-check-circle"></i>
  </button>
  <button class="btn btn-outline-danger btn-sm" (click)="declineRequest(req)">
    <i class="bi bi-x-circle"></i>
  </button>
</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>